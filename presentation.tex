%preamble
\documentclass{beamer} % use the beamer package for presentations
% \documentclass[notes=only]{beamer} %compile with this line uncommented to produce speaker notes
\usetheme{metropolis} % use the metropolis theme
\usepackage{wrapfig} % for text wrapping around figures

% used for making links within the document
\usepackage{hyperref}

% used for formatting code blocks
\usepackage[most]{tcolorbox}

% used for drawing shapes
\usepackage{tikz}

% sets the location of the graphics directory
\graphicspath{ {./assets/images/} }

% title slide setup
\title{Methods in \\Research Software Engineering}
\date{6th May 2021}
\author{Dr David Wilby}
\institute{\href{https://rse.shef.ac.uk}{Research Software Engineering Team},\\ The University of Sheffield}
\titlegraphic{\vspace*{4cm}\hspace*{7cm}\includegraphics[width=.3\textwidth]{RSE_logo_blackborder}}

% the main document
\begin{document}

  \begin{frame}
    \titlepage
  \end{frame}

  \begin{frame}{Outline}
    \begin{itemize}
      \item \hyperlink{INTRO}{Introduction}
      \item \hyperlink{RESEARCH}{Academic Research}
      \item \hyperlink{REPRO}{Reproducibility}
      \item \hyperlink{RSE}{Research Software Engineering}
      \item \hyperlink{GIT}{Version Control}
      \item \hyperlink{GITHUB}{GitHub}
      \item \hyperlink{BESTPRAC}{Best Practice}
      \item \hyperlink{LATEX}{LaTeX}
      \item \hyperlink{HPC}{High-Performance Computing}
      \item \hyperlink{RESOURCES}{Resources}
    \end{itemize}
  \end{frame}

  \begin{frame}[label=INTRO]{This Talk}
    \href{https://github.com/davidwilby/ResearchSoftwareMethods}{\includegraphics[width=\textwidth]{talk_repo_screenshot.png}}
    \url{https://github.com/davidwilby/ResearchSoftwareMethods}
  \end{frame}

  \begin{frame}{About Me}

    \begin{wrapfigure}{r}{0.3\textwidth}
        \includegraphics[width=0.3\textwidth]{wilby}
    \end{wrapfigure}

    David Wilby

    \href{https://davidwilby.github.io/}{davidwilby.github.io/}

    \textbf{Who?}
    
    Research Software Engineer

    \textbf{Background}

    Optical Physics, Sensory Biology, \\Numerical Simulation, HPC

    \textbf{Interests}

    Python, Git, Matlab, Open Source, Web Apps, Research Impact, Reproducibility

  \end{frame}

  \begin{frame}
    \begin{columns}
      \begin{column}{0.5\textwidth}
        \begin{center}
          \includegraphics[width=\textwidth]{bees.png}
        \end{center}
          \tiny
          \href{https://doi.org/10.1016/j.visres.2019.02.008}{Wilby \textit{et al.} (2018) \textit{Vision Research}}
      \end{column}

      \begin{column}{0.5\textwidth}
        \begin{center}
          \includegraphics[width=\textwidth]{fisheyes.png}
        \end{center}
        \tiny
        \href{https://doi.org/10.1364/JOSAA.33.001901}{Gagnon, Wilby \& Temple (2016) \textit{J. Opt. Soc. Am. A}}
      \end{column}
    \end{columns}
  \end{frame}

  \begin{frame}
    \begin{center}
      \includegraphics[height=0.9\textheight]{hermits.png}
    \end{center}
      \tiny
      \href{https://doi.org/10.1242/jeb.173831}{Wilby \textit(et al.) (2018) \textit{J. Exp. Biol.}}
  \end{frame}

  \begin{frame}
    \begin{columns}
      \begin{column}{0.5\textwidth}
        \begin{center}
          \includegraphics[height=0.8\textheight]{jexbio_220_11_coverfig.png}
        \end{center}
        \tiny
        \href{http://dx.doi.org/10.1098/rsif.2015.0591}{Wilby \textit{et al.} (2015) \textit{J. R. Soc. Interface}}\\
        \href{https://doi.org/10.1242/jeb.152918}{Wilby \& Roberts (2017) \textit{J. Exp. Biol.}}
      \end{column}
      \begin{column}{0.5\textwidth}
        \begin{center}
          \includegraphics[height=0.8\textheight]{IMG_20150414_152004.jpg}
        \end{center}
        \tiny
        \href{https://doi.org/10.1016/j.visres.2016.10.009}{Olsson, Wilby \& Kelber (2016) \textit{Vision Research}}\\
        \href{http://dx.doi.org/10.1098/rspb.2016.0411}{Olsson, Wilby \& Kelber (2016) \textit{Proc. R. Soc. B}}
      \end{column}
    \end{columns}
  \end{frame}

  \begin{frame}[label=RESEARCH]{Academic Research}
    \begin{center}
      \includegraphics[height=.8\textheight]{publication_cycle.png}
    \end{center}
    \tiny{Image: \href{https://press.rebus.community/literaturereviewsedunursing/chapter/chapter-2-what-is-a-literature-review/}{Rebus community}}
  \end{frame}

  \begin{frame}[label=REPRO]{Reproducibility}
    Is reproducibility really a problem?
    \pause
    \begin{center}
      \includegraphics[height=.7\textheight]{ioannidis.png}
    \end{center}
    \href{https://en.wikipedia.org/wiki/Replication_crisis}{Wikipedia: \underline{Replication crisis}}
  \end{frame}

  \begin{frame}
    \begin{center}
      \includegraphics[height=.8\textheight]{repro_articles.png}
    \end{center}
    \tiny
    \href{https://annakrystalli.me/rrresearchACCE20/slides/01_intro.html}{Credit: Anna Krystalli}
  \end{frame}

  \begin{frame}
    \begin{center}
      \includegraphics[height=.8\textheight]{new_scientist.png}
    \end{center}
    \href{https://www.newscientist.com/article/mg24732961-400-frustration-with-excel-has-caused-geneticists-to-rename-some-genes/}{New Scientist}
  \end{frame}

  \begin{frame}[label=RSE]{Research Software Engineering}
    \begin{columns}
      \begin{column}{0.4\textwidth}
        \textbf{Goals}
        \begin{itemize}
          \item reproducibility
          \item transparency
          \item accountability
          \item exendability
          \item lifespan
          \item impact
        \end{itemize}
        
        \textbf{Methods}
        \begin{itemize}
          \item version control
          \item open source code
          \item reliable code
          \item documentation
        \end{itemize}
      \end{column}

      \begin{column}{0.6\textwidth}
        \includegraphics[width=\textwidth]{RSE_graph_katz.png}
        \tiny{Image: \href{https://danielskatzblog.wordpress.com/2019/07/12/super-rses-combining-research-and-service-in-three-dimensions-of-research-software-engineering/}{\underline{Daniel S. Katz}}}
      \end{column}
  \end{columns}
  \end{frame}

  \begin{frame}{The FAIR Principles}
    \begin{columns}
      \begin{column}{0.3\textwidth}
        \huge
        \textbf{F}indable\\
        \textbf{A}ccessible\\
        \textbf{I}nteroperable\\
        \textbf{R}eusable\\
        \vspace{1cm}
        \tiny
        \href{https://www.nature.com/articles/sdata201618}{Wilkinson \textit{et al. Scientific Data} (2016)}
      \end{column}
      
      \begin{column}{0.7\textwidth}
        \includegraphics[width=\textwidth]{fair-principles.jpg}
        \tiny
        Image: \href{http://www.scriberia.co.uk/}{\underline{Scriberia}} for \href{https://the-turing-way.netlify.app/}{\underline{The Turing Way}}
      \end{column}
      
    \end{columns}
  \end{frame}

  \begin{frame}{Why do we need RSEs?}
    \begin{itemize}
      \item 92\% of academics use research software,
      \item 69\% say their research would not be practical without 
      \item 56\% develop their own software
      \item 21\% of those have no training in software development (!)
    \end{itemize}
    \vspace{2cm}
    \tiny
    Credit: \href{https://www.software.ac.uk/}{Software Sustainability Institute}
  \end{frame}


% Version Control
  \begin{frame}[label=GIT]{Why use version control?}
    \textbf{Interactive exercise}
    \\
    Go to \href{https://www.menti.com/}{\underline{menti.com}} and enter the code \textbf{8638 4246}
    \\
    or \href{https://www.menti.com/turid6cc7u}{\underline{follow this link}}
    \vspace{0.5cm}
    \pause
    \begin{itemize}
      \item try new ideas,
      \item confidence,
      \item ease of backing up (on remotes),
      \item facilitate collaboration.
    \end{itemize}
    
  \end{frame}


  \begin{frame}{Version Control}
    \begin{columns}
      \begin{column}{0.5\textwidth}
        Ways to use Git locally:
        \begin{itemize}
          \item \href{https://git-scm.com/}{Command Line Git \includegraphics[height=.05\textheight]{git}}
          \item \href{https://code.visualstudio.com/}{VS Code \includegraphics[height=.05\textheight]{vscode}}
          \item \href{https://www.gitkraken.com/}{GitKraken \includegraphics[height=.05\textheight]{gitkraken}}
          \item \href{https://gitforwindows.org/}{Git Bash \includegraphics[height=.07\textheight]{gitbash}}
          \item \href{https://www.rstudio.com/}{RStudio}
          \item + many more
        \end{itemize}
      \end{column}  
      \begin{column}[t]{0.5\textwidth}
        Online:
        \begin{itemize}
          \item \href{https://github.com/}{GitHub \includegraphics[height=.05\textheight]{github.png}}
          \item \href{https://gitlab.com/}{GitLab \includegraphics[height=.05\textheight]{gitlab.png}}
          \item \href{https://bitbucket.org/}{Bitbucket}
        \end{itemize}
      \end{column}  
    \end{columns}
  \end{frame}

  \begin{frame}{VS Code}
    \begin{center}
      \includegraphics[width=1.1\textwidth]{vscode_screenshot.png}
    \end{center}
  \end{frame}

  \begin{frame}{GitKraken}
    \includegraphics[width=\textwidth]{gitkraken_screenshot.png}
  \end{frame}

  \begin{frame}{Command Line Git}
    \includegraphics[width=\textwidth]{git_cmd_line_screenshot.png}
  \end{frame}


  \begin{frame}[fragile]{Git - useful commands}
    \begin{tcblisting}{beamer,colback=black,colupper=white,colframe=black,
      listing only,listing options={style=tcblatex,language=sh},hbox,
      every listing line*={\textcolor{cyan}{\small\ttfamily\bfseries\$}}}
  git status
    \end{tcblisting}
    Show current branch, staged/tracked/untracked files, current status.
    \includegraphics[height=.6\textheight]{git_status_output.png}
  \end{frame}


  \begin{frame}[fragile]
    'stash' your current unstaged changes.\newline
    \begin{tcblisting}{beamer,colback=black,colupper=white,colframe=black,
      listing only,listing options={style=tcblatex,language=sh},hbox,
      every listing line*={\textcolor{cyan}{\small\ttfamily\bfseries\$}}}
  git stash
    \end{tcblisting}
    
    \begin{tcblisting}{beamer,colback=black,colupper=white,colframe=black,
      listing only,listing options={style=tcblatex,language=sh},hbox}
> Saved working directory and index state WIP on main: 3a158fc add some notes
    \end{tcblisting}

    Another couple to try:
    \begin{tcblisting}{beamer,colback=black,colupper=white,colframe=black,
      listing only,listing options={style=tcblatex,language=sh},hbox,
      every listing line*={\textcolor{cyan}{\small\ttfamily\bfseries\$}}}
  git stash list
    \end{tcblisting}

    \begin{tcblisting}{beamer,colback=black,colupper=white,colframe=black,
      listing only,listing options={style=tcblatex,language=sh},hbox,
      every listing line*={\textcolor{cyan}{\small\ttfamily\bfseries\$}}}
  git stash pop
    \end{tcblisting}
    
  \end{frame}

  \begin{frame}[fragile]
    
    \begin{tcblisting}{beamer,colback=black,colupper=white,colframe=black,
      listing only,listing options={style=tcblatex,language=sh},hbox,
      every listing line*={\textcolor{cyan}{\small\ttfamily\bfseries\$}}}
  git remote -v
    \end{tcblisting}
    
    \begin{tcblisting}{beamer,colback=black,colupper=white,colframe=black,
      listing only,listing options={style=tcblatex,language=sh},hbox}
> origin git@github.com:davidwilby/ResearchSoftwareMethods (fetch)
> origin git@github.com:davidwilby/ResearchSoftwareMethods (push)
    \end{tcblisting}

  \end{frame}

  \begin{frame}[fragile]
    \begin{tcblisting}{beamer,colback=black,colupper=white,colframe=black,
      listing only,listing options={style=tcblatex,language=sh},hbox,
      every listing line*={\textcolor{cyan}{\small\ttfamily\bfseries\$}}}
  git log --decorate --all --oneline --graph
    \end{tcblisting}
    \includegraphics[height=.9\textheight]{git_log_tree_output.png}
  \end{frame}

  \begin{frame}{Git learning resources}
    \begin{columns}
      \begin{column}{0.5\textwidth}
        \begin{itemize}
          \item \href{http://swcarpentry.github.io/git-novice/}{\underline{software carpentry lesson}}
          \item \textit{"oh sh** git"} - \href{https://wizardzines.com/zines/oh-shit-git/}{\underline{zine}}, or \href{https://ohshitgit.com/}{\underline{blog}}
          \item \href{https://the-turing-way.netlify.app/reproducible-research/vcs.html}{\underline{The Turing Way}}
          \item \href{https://stackoverflow.com/}{\underline{stack overflow}} \textit{etc.} - \textit{use carefully}
          \item blogs on \href{https://dev.to/}{\underline{dev}} or \href{https://www.atlassian.com/git/tutorials}{\underline{atlassian}} \textit{etc.}
        \end{itemize}
      \end{column}
      \begin{column}{0.5\textwidth}
        \includegraphics[height=0.8\textheight]{ohshitgit.png}
      \end{column}
    \end{columns}
  \end{frame}

  \begin{frame}[label=GITHUB]{GitHub - collaboration}
    \begin{tikzpicture}
      \node[anchor=south west,inner sep=0] (image) at (0,0) {\includegraphics[width=\textwidth]{talk_repo_screenshot.png}};
      \draw<1>[red,ultra thick,rounded corners] (9.5,6.5) rectangle (10.8,7.3); % forking
      \draw<2>[red,ultra thick,rounded corners] (2.5,6) rectangle (4,6.5); % pull requests
    \end{tikzpicture}
  \end{frame}

  \note[itemize]{
    \item collaborate and play with existing repositories by forking or cloning
    \item if you have something to contribute back to a project, make a pull request
    \item many projects will have contribution guidelines
    }


  \begin{frame}{GitHub - project management}
    \begin{center}
      \includegraphics[width=\textwidth]{github_issues_screenshot.png}
    \end{center}
  \end{frame}

  \begin{frame}{GitHub - project management}
      \includegraphics[width=1.1\textwidth]{github_projects_screenshot.png}
  \end{frame}

  \begin{frame}{Best practice - documentation}
    You should document how to:
    \begin{itemize}
      \item install your software,
      \item use simply,
      \item more complex use cases,
      \item contribute,
      \item add tests,
      \item how long it will be maintained for,
      \item where packages are available,
      \item uninstall
    \end{itemize}
    Keep your documentation with the code and keep it up to date as you write more code.\\
    \pause
    \textbf{Remember}: documentation is for future you as well as others!
  \end{frame}

  \begin{frame}[fragile]{Best practice - testing}
    \includegraphics[height=0.8\textheight]{post-office-scandal.png}
    \\
    \tiny
    Credit: \href{https://www.private-eye.co.uk/pictures/special_reports/justice-lost-in-the-post.pdf}{Private Eye}
  \end{frame}


  \begin{frame}[fragile]{Best practice - testing}
    \begin{tcolorbox}[skin=beamer,adjusted title=Unit Tests]
      test the output of a single, basic function
    \end{tcolorbox}
    
    \begin{tcolorbox}[skin=beamer,adjusted title=Integration Tests]
      test the function of integrated units of code
    \end{tcolorbox}
    
    \begin{tcolorbox}[skin=beamer,adjusted title=Regression Tests]
      test that software still functions after a change
    \end{tcolorbox}
    
    \tiny
    Testing in research software:
    \begin{itemize}
      \item Still very important,
      \item Trade-off between cost, flexibility, etc at different points in the development life cycle,
      \item Useful in collaboration and open-source contribution.
    \end{itemize}
  \end{frame}

  \begin{frame}[label=CI]{Continuous Integration}
    \begin{center}
      \href{https://github.com/davidwilby/ResearchSoftwareMethods/actions}{
      \includegraphics[height=0.9\textheight]{githubactions_screenshot.png}
      }
    \end{center}
  \end{frame}

  \being{fame}
  This is a piece of code designed to break the compile.
  \end{thing}

  \begin{frame}[label=BESTPRAC]{Best practice - code style}
    \textbf{Interactive exercise}
    \\
    Go to \href{https://www.menti.com/}{\underline{menti.com}} and enter the code \textbf{8638 4246}
    \\
    or \href{https://www.menti.com/turid6cc7u}{\underline{follow this link}}
    \vspace{0.5cm}
    \pause
    \begin{itemize}
      \item Comments
      \item Conciseness
      \item DRY - Don't Repeat Yourself
      \item Modularity
      \item Follow conventions
    \end{itemize}
  \end{frame}

  \begin{frame}[fragile]{Best practice - project organisation}
        \small
        \begin{verbatim}
  data/
  docs/
  figs/
  output/
  src/
  tests/
  01_ingest_data.R
  02_clean_data.R
  03_exploratory_analysis.R
  04_fit_models.R
  05_generate_figures.R
  analysis_example.Rproj
  README.md\end{verbatim}
  \end{frame}

  \begin{frame}{Best practice - project organisation}
    \begin{itemize}
      \item be consistent
      \item include a license
      \item use machine/human readable filenames
    \end{itemize}
  \end{frame}

  % notes for slide above, only compiled with [notes] beamer flag (above)
  \note[itemize]{
  \item human readable filenames
  \item file specific READme files
  \item keep notes alongside your code, even if it's just for yourself
  \item keep papers too
  }

  \begin{frame}{Best practice - environment management}
    \begin{tcolorbox}[skin=beamer,adjusted title=Virtual environments]
      e.g. Conda, Venv, Renv (previously packrat)
    \end{tcolorbox}
    \begin{tcolorbox}[skin=beamer,adjusted title=Containers]
      e.g. Docker, Singularity
    \end{tcolorbox}
    \begin{tcolorbox}[skin=beamer,adjusted title=Virtual Machines]
      e.g. Vagrant,  VirtualBox
    \end{tcolorbox}    
  \end{frame}

  \begin{frame}[label=DATA]{Data Management}
    \begin{itemize}
      \item version your data
      \item perform cleaning steps programmatically
      \item make plots
      \item process raw data programmatically, don't edit it
      \item don't commit data to your git repo
    \end{itemize}
  \end{frame}

  \begin{frame}[label=LATEX]{\LaTeX}
    \includegraphics[width=\textwidth]{latex_example.png}
    \tiny
    Image: \href{https://data-mining.philippe-fournier-viger.com/using-latex-for-writing-research-papers/}{The Data Mining Blog}
  \end{frame}

  \begin{frame}{\LaTeX}
    \textbf{Why bother?}
    \begin{itemize}
      \item Scripted (i.e. text-based) documents are simpler to version control,
      \item Referencing is much cleaner,
      \item Simpler management of large documents,
      \item It's free,
      \item Portability,
      \item Aesthetics,
      \item Maths typesetting,
    \end{itemize}
  \end{frame}

  \begin{frame}{\LaTeX}
    Alternatively use a GUI such as \href{https://www.lyx.org/}{LyX}
    \\
    \includegraphics[height=\textheight]{lyx.png}
  \end{frame}
  
  \begin{frame}[label=HPC]{High-Performance Computing}
    \begin{columns}
      \begin{column}{0.5\textwidth}
        Why use HPC?
        \begin{itemize}
          \item Parallel computing
          \item Batch management
          \item Access to GPUs
          \item Run analysis elsewhere
          \item Efficiency
        \end{itemize}

        \vspace{1cm}

        Resources available at TUoS:
        \begin{itemize}
          \item \href{https://docs.hpc.shef.ac.uk/en/latest/sharc/index.html}{\underline{ShARC}}
          \item \href{https://docs.hpc.shef.ac.uk/en/latest/bessemer/index.html}{\underline{Bessemer}}
        \end{itemize}
      \end{column}
      
      \begin{column}{0.5\textwidth}
        \includegraphics[width=\textwidth]{iceberg2014.jpg}
        \tiny
        Image: \href{https://www.sheffield.ac.uk/it-services/research/hpc/sharc}{TUoS Research IT}
        \small
        \\\vspace{1cm}
        HPC @ TUoS presentations:
        \begin{itemize}
          \item \href{https://rse.shef.ac.uk/uos-hpc-resources-presentation/}{\underline{Twin Karmakharm}}
          \item \href{https://rse.shef.ac.uk/rse-dcs-pres-on-hpc/}{\underline{Will Furnass}}
        \end{itemize}
      \end{column}
    \end{columns}
  \end{frame}

  \begin{frame}{Key Points}
    \begin{itemize}
      \item document, document, document
      \item keep things simple
      \item version control code \& data
      \item isolate environments
      \item good research code is just good code
      \item try your best!
    \end{itemize}
  \end{frame}

  \begin{frame}[label=RESOURCES]{Great Resources}
    \begin{center}
      \href{https://www.britishecologicalsociety.org/wp-content/uploads/2019/06/BES-Guide-Reproducible-Code-2019.pdf}{\includegraphics[height=0.4\textheight]{bes_reproducible_code.jpg}}
      \hspace{1cm}
      \href{https://the-turing-way.netlify.app/}{\includegraphics[height=0.4\textheight]{turing_way.jpg}}
    \end{center}
    \begin{itemize}
      \item \href{https://www.britishecologicalsociety.org/wp-content/uploads/2019/06/BES-Guide-Reproducible-Code-2019.pdf}{\underline{BES Guide to Reproducible Research Code}}
      \item \href{https://the-turing-way.netlify.app/}{\underline{The Turing Way}}
      \item \href{https://software.ac.uk/}{\underline{Software Sustainability Institute}}
      \item \href{https://github.com/davidwilby/ResearchSoftwareMethods}{\underline{This talk!}}
    \end{itemize}
  \end{frame}

\end{document}
